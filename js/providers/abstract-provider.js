Number.prototype.formatSize=function(){var e=Math.round;let t=this,i="B";return 1024<t&&(t=e(t/1024*100)/100,i="KB"),1024<t&&(t=e(t/1024*100)/100,i="MB"),1024<t&&(t=e(t/1024*100)/100,i="GB"),t+i},String.prototype.clearFilename=function(){return this.replace(/^\./,"_").replace(/\t/g," ").replace(/[\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200b-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,"").replace(/&quot;/g,"").replace(/&amp;/g,"&").replace(/â†µ/g," ").replace(/[\\/:*?<>|~"]/g,"_").slice(0,100)};const INIT_CLASS="mtz-vlc-"+chrome.runtime.id,AbstractProvider=class{constructor(){this.ids={},this.videos=[],this.setBadge()}run(){setInterval(()=>this.search(),1e3)}search(){}addVideo(e,t){this.ids[e]=!0,this.getVideoData(e,e=>e.variants.length?void this.getAllSizes(e.variants,t=>{e.variants=t,this.videos=this.videos.concat(e),this.setBadge()}):void 0,t)}getVideoData(){}setBadge(){chrome.runtime.sendMessage({action:"setBadge",value:this.videos})}download(e){let t=e.closest("[vid]").getAttribute("vid"),i=e.getAttribute("quality");if(!i)return;let r=this.videos.find(e=>e.vid===t),s=r.variants.find(e=>e.quality===i),$={title:r.title,url:s.url};return r&&s?void chrome.runtime.sendMessage({action:"downloadVideo",data:$}):void 0}getAllSizes(e,t){e=e.reverse();let i=e.map(e=>this.getFileSize(e.url));Promise.all(i).then(i=>{e.forEach((t,r)=>e[r].size=i[r]),t(e)})}getFileSize(e){return new Promise(t=>{let i=new XMLHttpRequest;i.open("HEAD",e,!0),i.onload=()=>{if(200===i.status){let e=+i.getResponseHeader("Content-Length");return t(e)}t(0)},i.onerror=()=>t(0),i.send()})}getCookie(e){var t=("; "+document.cookie).split("; "+e+"=");if(2==t.length)return t.pop().split(";").shift()}betweenStr(e,t,i){if(!t&&!i)return e;let r="",s=e.indexOf(t);if(-1===s&&(r=""),0<=s&&(r=e.substr(s+t.length,e.length)),!i)return r;let $=r.indexOf(i);return -1===$&&-1!==s||-1===$?"":r=r.substr(0,$)}};