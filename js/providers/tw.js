const TWProvider=class extends AbstractProvider{constructor(){super()}search(){$("video").not("."+INIT_CLASS).each((e,t)=>{let r=$(t),i=r.closest("article"),d=this.getTweetId(i),s=r.parent();d&&!this.ids[d]&&this.addVideo(d,s),r.addClass(INIT_CLASS)})}getTweetId(e){return this.getTweetData(e,/(?:https:\/\/[A-z.]*\/\w*\/status\/)(\d*)(?:\/?\w*)/g)}getTweetData(e,t){for(let r of e.find("a").toArray()){let i=t.exec(r.href);if(i)return i[1]}}getVideoData(e,t){chrome.storage.local.get("currentTwitterHeaders",r=>{let i=r.currentTwitterHeaders.reduce((e,t)=>{let r=t.name,i=t.value;return{...e,[r]:i}},{});chrome.runtime.sendMessage({action:"makeXHRrequest",url:`https://api.twitter.com/2/timeline/conversation/${e}.json?include_profile_interstitial_type=1&include_blocking=1&include_blocked_by=1&include_followed_by=1&include_want_retweets=1&include_mute_edge=1&include_can_dm=1&include_can_media_tag=1&skip_status=1&cards_platform=Web-12&include_cards=1&include_composer_source=true&include_ext_alt_text=true&include_reply_count=1&tweet_mode=extended&include_entities=true&include_user_entities=true&include_ext_media_color=true&include_ext_media_availability=true&send_error_codes=true&simple_quoted_tweets=true&count=20&ext=mediaStats%252ChighlightedLabel%252CcameraMoment`,config:{method:"GET",headers:i}},r=>{if(null==r||chrome.runtime.lastError){console.log(`error = ${chrome.runtime.lastError||"No response."}`);return}let i=r.globalObjects.tweets[e].extended_entities.media[0].video_info.variants,d=r.globalObjects.users[r.globalObjects.tweets[e].user_id_str].name,s=`Video by ${d} (${e})`,n=i.filter(e=>"video/mp4"===e.content_type);t({vid:n,title:s,provider:"tw",variants:i})})})}};